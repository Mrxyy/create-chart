(self["webpackChunkcreate_chart"]=self["webpackChunkcreate_chart"]||[]).push([[2447],{98046:function(e){e.exports={"component-other-iframe":"component-other-iframe___17Fs4"}},8982:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return N}});var a,i,r=t(67294),s=t(96486),o=t(94184),l=t.n(o),c=t(51505),u=t(45210),h=t(94610),d=t(69421),v=t(9101),f=t(11849),m=t(93224),g=t(69610),A=t(54941),p=t(97603),y=t(89492),_=["id","actionType"];(function(e){e["INIT_RELATION_PARAMS"]="INIT_RELATION_PARAMS",e["RELATION_PARAMS_CHANGE"]="RELATION_PARAMS_CHANGE",e["POST_PARAMS"]="POST_PARAMS"})(a||(a={})),function(e){e["GET_PARAMS"]="GET_PARAMS",e["RELATION_PARAMS_CHANGE"]="RELATION_PARAMS_CHANGE"}(i||(i={}));var P=function(){function e(n,t){(0,g.Z)(this,e),this.iframeId="",this.iframeWindow=void 0,this.iframeUrl="",this.interactive=void 0,this.iframeId=n,this.interactive=t}return(0,A.Z)(e,[{key:"eventBind",value:function(){window.addEventListener("message",this.onMessage)}},{key:"eventUnBind",value:function(){window.removeEventListener("message",this.onMessage)}},{key:"onMessage",value:function(e){var n;try{var t=e.data,r=e.origin,s=JSON.parse(t),o=s.id,l=s.actionType,c=(0,m.Z)(s,_);if(o!==this.iframeId||this.getDomain(this.iframeUrl)!==this.getDomain(r)||!i[l])return;switch(l){case i.GET_PARAMS:var u=c.value;if(Array.isArray(u)){var h=this.getGlobalData(),d=h.params,v=h.constants,f=y.Z.getAllGlobalParams4Array(d,v);this.postMessage({actionType:a.POST_PARAMS,value:u.map((function(e){return f.find((function(n){return n.key===e}))})).filter(Boolean).map((function(e){return{key:e.key,value:e.value}}))})}break;case i.RELATION_PARAMS_CHANGE:default:null===(n=this.interactive)||void 0===n||n.call(this,"message",c)}}catch(g){}}},{key:"getDomain",value:function(e){try{return new URL(e).origin}catch(n){return""}}},{key:"getGlobalData",value:function(){var e=(0,p.pA)();return(0,s.get)(e,"screenData.config.attr")}},{key:"postMessage",value:function(e){this.iframeWindow&&this.iframeWindow.postMessage(JSON.stringify((0,f.Z)((0,f.Z)({},e),{},{id:this.iframeId})),this.getDomain(this.iframeUrl))}},{key:"onParamsChange",value:function(e,n){this.postMessage({value:[{key:e.variable,value:n}],actionType:a.RELATION_PARAMS_CHANGE})}},{key:"create",value:function(e,n){this.eventUnBind(),this.iframeWindow=window.frames[this.iframeId],this.iframeUrl=e,this.eventBind();var t=this.getGlobalData(),i=t.params,r=t.constants,s=y.Z.getAllGlobalParams4Array(i,r),o=n.map((function(e){var n=s.find((function(n){return n.id===e}));return n?{key:n.key,value:n.value}:null})).filter(Boolean);this.postMessage({value:o,actionType:a.INIT_RELATION_PARAMS})}},{key:"destroy",value:function(){this.iframeWindow=null,this.eventUnBind()}}]),e}(),R=P,b=t(91537),Z=t(98046),M=t.n(Z),k=t(85893),E=function(e){var n=e.className,t=e.style,a=e.value,i=e.global,o=e.children,f=e.wrapper,m=a.id,g=a.config,A=g.options,p=A.scrolling,y=A.scale,_=A.pointEvent,P=A.relationParams,Z=g.style.border,E=(0,r.useRef)((0,s.uniqueId)(b.q)),C=(0,r.useRef)(!1),N=(0,h.Co)({component:a,global:i}),x=N.request,I=N.getValue,T=N.requestUrl,j=N.componentFilter,w=N.value,S=void 0===w?[]:w,G=N.componentFilterMap,O=N.syncInteractiveAction,L=(0,r.useRef)(new R(E.current,O)),D=(0,r.useMemo)((function(){var e;return null===(e=v.ZP.getFieldMapValue(S,{map:G}))||void 0===e?void 0:e.value}),[S,G]),U=(0,r.useCallback)((function(){C.current=!0,F(D)}),[D]),B=(0,r.useCallback)((function(e,n){var t;D&&(null===(t=L.current)||void 0===t||t.onParamsChange(e,n))}),[]),F=function(e){var n;e&&C.current&&(null===(n=L.current)||void 0===n||n.create(e,P))};return(0,c.Z)((function(){F(D)}),[D]),(0,u.Z)((function(){var e;null===(e=L.current)||void 0===e||e.destroy()})),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:l()(n,M()["component-other-iframe"]),style:(0,s.merge)({width:"100%",height:"100%"},t),id:E.current,children:(0,k.jsx)("div",{className:"w-100 h-100",style:(0,s.merge)({transform:"scale(".concat(y,")")},_?{}:{pointerEvents:"none"}),children:(0,k.jsxs)(f,{border:Z,children:[o,(0,k.jsx)("iframe",{src:D,name:E.current,width:"100%",height:"100%",frameBorder:"0",scrolling:p,onLoad:U,style:_?{}:{pointerEvents:"none"}})]})})}),(0,k.jsx)(d.Z,{id:m,url:T,reFetchData:x,reGetValue:I,reParams:B,componentFilter:j,componentParams:P})]})},C=E;C.id=b.q;var N=C},49630:function(e,n,t){"use strict";t.r(n);t(77576);var a=t(59314),i=t(32059),r=t(69610),s=t(54941),o=t(81306),l=t(80017),c=t(67294),u=t(35931),h=t(66656),d=t(28832),v=t(13631),f=t(79837),m=t(74117),g=t(74510),A=t(85893),p=v.Z.Item,y=function(e){(0,o.Z)(t,e);var n=(0,l.Z)(t);function t(){var e;(0,r.Z)(this,t);for(var a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];return e=n.call.apply(n,[this].concat(s)),e.onKeyChange=function(n,t){e.props.onChange({config:{options:(0,i.Z)({},n,t)}})},e}return(0,s.Z)(t,[{key:"render",value:function(){var e=this.props.value,n=e.config.options,t=n.scale,i=n.scrolling,r=n.pointEvent,s=n.relationParams;return(0,A.jsx)(u.Z,{items:[{label:(0,A.jsx)(u.O,{children:"\u5168\u5c40\u914d\u7f6e"}),children:(0,A.jsxs)(v.Z,{level:1,children:[(0,A.jsx)(p,{label:"\u70b9\u51fb\u4e8b\u4ef6",children:(0,A.jsx)(f.Z,{children:(0,A.jsx)(a.Z,{checked:r,onChange:this.onKeyChange.bind(this,"pointEvent")})})}),(0,A.jsx)(p,{label:"\u5173\u8054\u53c2\u6570",placeholder:(0,A.jsx)(g.rl,{}),children:(0,A.jsx)(f.Z,{children:(0,A.jsx)(m.Z,{value:s,onChange:this.onKeyChange.bind(this,"relationParams")})})}),(0,A.jsx)(p,{label:"\u6eda\u52a8\u6761",children:(0,A.jsx)(f.Z,{children:(0,A.jsx)(h.Z,{className:"w-100",value:i,onChange:this.onKeyChange.bind(this,"scrolling"),options:[{label:"\u81ea\u52a8",value:"auto"},{label:"\u663e\u793a",value:"yes"},{label:"\u9690\u85cf",value:"no"}]})})}),(0,A.jsx)(p,{label:"\u653e\u5927",children:(0,A.jsx)(f.Z,{children:(0,A.jsx)(d.Z,{value:t,onChange:this.onKeyChange.bind(this,"scale")})})})]}),key:"1"}]})}}]),t}(c.Component);n["default"]=y}}]);